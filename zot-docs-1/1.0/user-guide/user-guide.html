<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Zot User Guide :: Zot Docs</title>
    <meta name="generator" content="Antora 3.0.1">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../..">Zot Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="zot-docs-1" data-version="1.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../developer-guide/draft-developer-guide-chapters.html">Zot-Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../developer-guide/draft-developer-guide-chapters.html">Zot Developer Guide</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="user-guide.html">Zot User Guide</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Zot-Documentation</span>
    <span class="version">1.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../developer-guide/draft-developer-guide-chapters.html">Zot-Documentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../developer-guide/draft-developer-guide-chapters.html">1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../developer-guide/draft-developer-guide-chapters.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../developer-guide/draft-developer-guide-chapters.html">Zot-Documentation</a></li>
    <li><a href="user-guide.html">Zot User Guide</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/raulkele/docs-zot/edit/main/modules/user-guide/pages/user-guide.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Zot User Guide</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a>
<ul class="sectlevel2">
<li><a href="#_what_is_zot">What is zot</a></li>
<li><a href="#_why_zot">Why zot?</a></li>
</ul>
</li>
<li><a href="#_getting_started">Getting Started</a>
<ul class="sectlevel2">
<li><a href="#_building_zot_from_source">Building zot from Source</a></li>
<li><a href="#_launching_zot_with_a_configuration_file">Launching zot with a Configuration File</a></li>
</ul>
</li>
<li><a href="#_zot_server_configuration">Zot Server Configuration</a>
<ul class="sectlevel2">
<li><a href="#_network">Network</a></li>
<li><a href="#_logging">Logging</a></li>
<li><a href="#_storage">Storage</a></li>
<li><a href="#_authentication">Authentication</a></li>
<li><a href="#_identity_based_authorization">Identity-Based Authorization</a></li>
<li><a href="#_metrics">Metrics</a></li>
<li><a href="#_synchronizing_registries">Synchronizing Registries</a></li>
<li><a href="#_clustering_zot">Clustering zot</a></li>
</ul>
</li>
<li><a href="#_working_with_zli">Working with zli</a>
<ul class="sectlevel2">
<li><a href="#_what_is_zli">What is zli?</a></li>
<li><a href="#_build_zli_from_source">Build zli from Source</a></li>
<li><a href="#_common_tasks_using_zli">Common Tasks Using zli</a></li>
<li><a href="#_zli-command-reference">zli Command Reference</a></li>
</ul>
</li>
<li><a href="#_working_with_zb">Working with zb</a>
<ul class="sectlevel2">
<li><a href="#_what_is_zb">What is zb?</a></li>
</ul>
</li>
<li><a href="#_advanced_topics_cookbook">Advanced Topics Cookbook</a>
<ul class="sectlevel2">
<li><a href="#_advanced_topics_cookbook_2">Advanced Topics Cookbook</a></li>
</ul>
</li>
<li><a href="#_notices">Notices</a>
<ul class="sectlevel2">
<li><a href="#_bias_free_language">Bias-Free language</a></li>
</ul>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a><a class="link" href="#_introduction">Introduction</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_what_is_zot"><a class="anchor" href="#_what_is_zot"></a><a class="link" href="#_what_is_zot">What is zot</a></h3>
<div class="paragraph">
<p>Zot is an open-source, vendor-neutral image registry application based purely
on the <a href="https://github.com/opencontainers/distribution-spec">OCI Distribution Specification</a>
published by the Open Container Initiative (OCI).</p>
</div>
<div class="paragraph">
<p>An OCI image registry is a server-based application that allows you to store, manage, and share
container images.  A developer uploads (pushes) an image to the registry for distribution. Users can
then download (pull) the image to run on their systems.  The OCI Distribution Specification
defines a standard API protocol for these and other image registry operations.</p>
</div>
<div class="paragraph">
<p>You can host an OCI image repository by installing Zot on your public
or private server.  You can download or clone the zot project from
GitHub at <a href="https://github.com/project-zot/zot">project-zot</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_why_zot"><a class="anchor" href="#_why_zot"></a><a class="link" href="#_why_zot">Why zot?</a></h3>
<div class="paragraph">
<p>Unlike Zot, many commonly-used image registries do not fully conform to the
<a href="https://github.com/opencontainers/distribution-spec">OCI Distribution Specification</a>.</p>
</div>
<div class="paragraph">
<p>The following table compares the capabilities of zot with another common
image registry.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">zot</th>
<th class="tableblock halign-left valign-top"><a href="https://github.com/distribution/distribution">Docker distribution</a></th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Last stable release</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v1.3.0 (Sep 1, 2021)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v2.7.1 (Jan 17, 2019)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>License</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache 2.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache 2.0</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On-premise deployment</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Minimal build</strong>*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Storage Layout</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ociv1 image layout [2]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">project-specific layout [1]</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Authentication</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">built-in</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">auxiliary [3]</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Authorization</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">built-in</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">auxiliary [3]</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Garbage collection</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">inline</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">requires server shutdown</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Storage deduplication</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">inline</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Cloud storage support</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Delete by tag</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unsupported [4][5]</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Vulnerability scanning</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">built-in</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cli</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ui</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes [8]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">auxiliary [3][4]</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>External contributions</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CNCF project</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes [9]</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>dist-spec conformance</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes [12]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pending 3.x release [10][11]</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Image Signatures</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">built-in [14][15]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">auxiliary [13]</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
* The <strong>minimal build</strong> feature is the ability to build a minimal
distribution-spec compliant registry in order to reduce library dependencies
and the possible attack surface.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_table_references"><a class="anchor" href="#_table_references"></a><a class="link" href="#_table_references">Table References</a></h4>
<div class="paragraph">
<p>[1] <a href="https://github.com/distribution/distribution/tree/main/registry/storage" class="bare">https://github.com/distribution/distribution/tree/main/registry/storage</a></p>
</div>
<div class="paragraph">
<p>[2] <a href="https://github.com/opencontainers/image-spec" class="bare">https://github.com/opencontainers/image-spec</a></p>
</div>
<div class="paragraph">
<p>[3] <a href="https://github.com/cesanta/docker_auth" class="bare">https://github.com/cesanta/docker_auth</a></p>
</div>
<div class="paragraph">
<p>[4] <a href="https://github.com/distribution/distribution/issues/3234" class="bare">https://github.com/distribution/distribution/issues/3234</a></p>
</div>
<div class="paragraph">
<p>[5] <a href="https://github.com/distribution/distribution/issues/2747" class="bare">https://github.com/distribution/distribution/issues/2747</a></p>
</div>
<div class="paragraph">
<p>[6] <a href="https://github.com/Joxit/docker-registry-ui" class="bare">https://github.com/Joxit/docker-registry-ui</a></p>
</div>
<div class="paragraph">
<p>[7] <a href="https://github.com/parabuzzle/craneoperator" class="bare">https://github.com/parabuzzle/craneoperator</a></p>
</div>
<div class="paragraph">
<p>[8] <a href="https://github.com/project-zot/zot-ui" class="bare">https://github.com/project-zot/zot-ui</a></p>
</div>
<div class="paragraph">
<p>[9] <a href="https://www.docker.com/blog/donating-docker-distribution-to-the-cncf/" class="bare">https://www.docker.com/blog/donating-docker-distribution-to-the-cncf/</a></p>
</div>
<div class="paragraph">
<p>[10] <a href="https://github.com/distribution/distribution/issues/3203" class="bare">https://github.com/distribution/distribution/issues/3203</a></p>
</div>
<div class="paragraph">
<p>[11] <a href="https://github.com/opencontainers/oci-conformance/tree/main/distribution-spec#distributiondistribution" class="bare">https://github.com/opencontainers/oci-conformance/tree/main/distribution-spec#distributiondistribution</a></p>
</div>
<div class="paragraph">
<p>[12] <a href="https://github.com/opencontainers/oci-conformance/tree/main/distribution-spec#project-zotzot" class="bare">https://github.com/opencontainers/oci-conformance/tree/main/distribution-spec#project-zotzot</a></p>
</div>
<div class="paragraph">
<p>[13] <a href="https://docs.docker.com/engine/security/trust/" class="bare">https://docs.docker.com/engine/security/trust/</a></p>
</div>
<div class="paragraph">
<p>[14] <a href="https://github.com/notaryproject/notation" class="bare">https://github.com/notaryproject/notation</a></p>
</div>
<div class="paragraph">
<p>[15] <a href="https://github.com/sigstore/cosign" class="bare">https://github.com/sigstore/cosign</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started"><a class="anchor" href="#_getting_started"></a><a class="link" href="#_getting_started">Getting Started</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_building_zot_from_source"><a class="anchor" href="#_building_zot_from_source"></a><a class="link" href="#_building_zot_from_source">Building zot from Source</a></h3>
<div class="sect3">
<h4 id="_supported_platforms"><a class="anchor" href="#_supported_platforms"></a><a class="link" href="#_supported_platforms">Supported Platforms</a></h4>
<div class="paragraph">
<p>Zot is officially supported on <code>Linux</code> and <code>Apple MacOS</code> platforms. However,
development should be possible on any platform that supports the <code>golang</code> toolchain.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a><a class="link" href="#_prerequisites">Prerequisites</a></h4>
<div class="sect4">
<h5 id="_install_golang_1_17"><a class="anchor" href="#_install_golang_1_17"></a><a class="link" href="#_install_golang_1_17">Install golang (1.17+)</a></h5>
<div class="paragraph">
<p>The zot project requires <code>golang 1.17</code> or newer. You can follow
<a href="https://go.dev/learn/">these instructions</a> to install the <code>golang</code> toolchain.  After
installation, make sure that the <code>path</code> environment variable or your IDE can find
the toolchain.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_cloning_zot"><a class="anchor" href="#_cloning_zot"></a><a class="link" href="#_cloning_zot">Cloning zot</a></h4>
<div class="paragraph">
<p>You can download or clone the full zot project from GitHub at
<a href="https://github.com/project-zot/zot">project-zot</a>.
To clone the zot project, use this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ git clone https://github.com/project-zot/zot.git</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_building_zot"><a class="anchor" href="#_building_zot"></a><a class="link" href="#_building_zot">Building zot</a></h4>
<div class="paragraph">
<p>To build zot, execute the <code>make</code> command in the zot directory
using the following general syntax:</p>
</div>
<div class="paragraph">
<p><code>$ make OS=<em>os</em> ARCH=<em>architecture</em> {binary | binary-minimal}</code></p>
</div>
<div class="paragraph">
<p>The <code>binary</code> option builds the full zot binary with all extensions.<br>
The <code>binary-minimal</code> option builds the minimal zot binary without extensions.</p>
</div>
<div class="paragraph">
<p>Extensions include functions such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>metrics</p>
</li>
<li>
<p>synchronization</p>
</li>
<li>
<p>search</p>
</li>
<li>
<p>scrub</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_examples"><a class="anchor" href="#_examples"></a><a class="link" href="#_examples">Examples</a></h5>
<div class="paragraph">
<p>The following are examples of the <code>make</code> command for several supported platforms
and architectures:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Linux/Intel-based platforms</p>
<div class="listingblock">
<div class="content">
<pre>$ make OS=linux ARCH=amd64 binary</pre>
</div>
</div>
</li>
<li>
<p>Linux/amd64 platform</p>
<div class="listingblock">
<div class="content">
<pre>$ make OS=linux ARCH=amd64 binary</pre>
</div>
</div>
</li>
<li>
<p>Linux/ARM64-based platforms such as ARM64 servers and Raspberry Pi4</p>
<div class="listingblock">
<div class="content">
<pre>$ make OS=linux ARCH=arm64 binary</pre>
</div>
</div>
</li>
<li>
<p>Apple MacOS/Intel-based platforms</p>
<div class="listingblock">
<div class="content">
<pre>$ make OS=darwin ARCH=amd64 binary</pre>
</div>
</div>
</li>
<li>
<p>Apple MacOS/ARM64-based platforms</p>
<div class="listingblock">
<div class="content">
<pre>$ make OS=darwin ARCH=arm64 binary</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>After running <code>make</code>, you can find the resulting executable file in the
<code>zot/bin</code> directory.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The filename of the executable file will reflect the build options.
For example, a linux build will result in a file named
<code>zot-darwin-amd64.</code> For convenience, you can rename the file to simply <code>zot.</code>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_additional_details"><a class="anchor" href="#_additional_details"></a><a class="link" href="#_additional_details">Additional Details</a></h4>
<div class="paragraph">
<p>For detailed instructions, see the <em>Zot Developers Guide</em> on the GitHub
<a href="https://github.com/project-zot/docs-zot">docs-zot</a> page.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_launching_zot_with_a_configuration_file"><a class="anchor" href="#_launching_zot_with_a_configuration_file"></a><a class="link" href="#_launching_zot_with_a_configuration_file">Launching zot with a Configuration File</a></h3>
<div class="paragraph">
<p>The zot service is initiated from the command line using the following
command format:</p>
</div>
<div class="paragraph">
<p><code>$ <strong>bin/zot</strong> <strong>serve</strong> <em>configfile</em></code></p>
</div>
<div class="paragraph">
<p>The configuration file is a JSON or YAML file that contains all configuration
settings for zot functions such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>network</p>
</li>
<li>
<p>logging</p>
</li>
<li>
<p>storage</p>
</li>
<li>
<p>authentication</p>
</li>
<li>
<p>authorization</p>
</li>
<li>
<p>metrics</p>
</li>
<li>
<p>synchronization with other registries</p>
</li>
<li>
<p>clustering</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A simple JSON configuration file is shown in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
    "distSpecVersion": "1.0.1",
    "storage": {
        "rootDirectory": "/tmp/zot"
    },
    "http": {
        "address": "127.0.0.1",
        "port": "8080",
        "ReadOnly": false
    },
    "log": {
        "level": "debug"
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>The first attribute of the JSON data is the distribution specification version
(<code>distSpecVersion</code>). The structure and content of other attributes are described
in the later sections of this guide.</p>
</div>
<div class="paragraph">
<p>Using the information in this guide, compose a configuration file with the
settings and features you require for your zot registry server.
Before deploying zot, verify the syntax of your configuration file by
using the following command:</p>
</div>
<div class="paragraph">
<p><code>$ <strong>bin/zot</strong> <strong>verify</strong> <em>configfile</em></code></p>
</div>
<div class="paragraph">
<p>After verifying your configuration file, launch zot with the following
command:</p>
</div>
<div class="paragraph">
<p><code>$ <strong>bin/zot</strong> <strong>serve</strong> <em>configfile</em></code></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_zot_server_configuration"><a class="anchor" href="#_zot_server_configuration"></a><a class="link" href="#_zot_server_configuration">Zot Server Configuration</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_network"><a class="anchor" href="#_network"></a><a class="link" href="#_network">Network</a></h3>
<div class="paragraph">
<p>Use the <code>http</code> attribute in the configuration file to configure the zot
network settings, as shown in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"http": {
  "address":"127.0.0.1",
  "port":"8080",
  "realm":"zot",
  "tls": {
    "cert":"test/data/server.cert",
    "key":"test/data/server.key"
  }}</pre>
</div>
</div>
<div class="paragraph">
<p>The following table lists the configurable attributes.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>address</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The IP address of the zot server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The port number of the zot server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>realm</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The security policy domain defined for the server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tls</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The included attributes in this section specify the Transport Layer
Security (TLS) settings for the server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cert</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path and filename of the server&#8217;s SSL/TLS certificate.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>key</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path and filename of the server&#8217;s registry key.</p></td>
</tr>
</tbody>
</table>
<div class="sidebarblock">
<div class="content">
<div class="title">MIKE&#8217;S QUESTIONS</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Are these the only attributes?</p>
</li>
<li>
<p>Are there defaults?</p>
</li>
<li>
<p>Should <code>allowReadAccess</code> be documented here?</p>
</li>
<li>
<p>What&#8217;s the difference between <code>allowReadAccess</code> and <code>ReadOnly</code>?  Both appear in examples.</p>
</li>
<li>
<p>Should <code>Ratelimit</code> be documented here?</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_logging"><a class="anchor" href="#_logging"></a><a class="link" href="#_logging">Logging</a></h3>
<div class="paragraph">
<p>Logging for zot operations is configured with the <code>log</code> attribute in the
configuration file, as shown in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"log":{
  "level":"debug",
  "output":"/tmp/zot.log",
  "audit": "/tmp/zot-audit.log"
}</pre>
</div>
</div>
<div class="paragraph">
<p>The following table lists the configurable attributes.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>level</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The minimum level for logged events. The levels are:<br>
<code>emergency,</code>
<code>alert,</code> <code>critical,</code> <code>error,</code> <code>warning,</code> <code>notification,</code> <code>informational,</code>
and <code>debug.</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>output</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The filesystem path for the log output file. The default is <code>stdout</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>audit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) If a filesystem path is specified for audit logging, an audit log is
enabled and will be stored at the specified path.</p></td>
</tr>
</tbody>
</table>
<div class="sidebarblock">
<div class="content">
<div class="title">MIKE&#8217;S QUESTIONS</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Are these the only attributes?</p>
</li>
<li>
<p>Are the correct levels shown?  Is there a default level?</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_storage"><a class="anchor" href="#_storage"></a><a class="link" href="#_storage">Storage</a></h3>
<div class="paragraph">
<p>With zot, you have the option to store your registry image files either
in local filesystem storage or in cloud storage, such as in an Amazon Simple Storage
Service (S3) bucket.</p>
</div>
<div class="sect3">
<h4 id="_configuring_local_storage"><a class="anchor" href="#_configuring_local_storage"></a><a class="link" href="#_configuring_local_storage">Configuring Local Storage</a></h4>
<div class="paragraph">
<p>Local filesystem storage for zot is configured with the <code>storage</code>
attribute in the configuration file, as shown in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"storage":{
  "rootDirectory":"/tmp/zot"
  "dedupe": true,
  "gc": true,
  "gcDelay": "1h",
  "gcInterval": "24h"
}</pre>
</div>
</div>
<div class="paragraph">
<p>The following table lists the configurable attributes.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rootDirectory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Location  of the images stored in the server file system.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dedupe</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the server filesystem supports hard links, you can enable inline
deduplication of layers and blobs that are shared among multiple container images.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When an image is deleted (either by tag or reference), orphaned blobs
can lead to wasted storage.  Set to <code>true</code> to enable background garbage collection to
reclaim this space.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gcDelay</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) If configured, causes garbage collection to run once after
the specified delay time. Requires the <code>gc</code> attribute to be <code>true.</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gcInterval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) If configured, causes garbage collection to run periodically
at the specified interval. Requires the <code>gc</code> attribute to be <code>true.</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>subpaths</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>You can store and serve images from multiple filesystems, each with
their own repository paths and settings. The following example shows three subpaths.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"storage":{
  "subPaths": {
    "/a": {
      "rootDirectory": "/tmp/zot1",
      "dedupe": true,
      "gc": true
    },
    "/b": {
      "rootDirectory": "/tmp/zot2",
      "dedupe": true
    },
    "/c": {
      "rootDirectory": "/tmp/zot3",
      "dedupe": false
    }
  }
}</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="sidebarblock">
<div class="content">
<div class="title">MIKE&#8217;S QUESTIONS</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Are these the only attributes?</p>
</li>
<li>
<p>Are the dedupe and gc attributes optional and are the defaults FALSE if not specified?</p>
</li>
<li>
<p>What values are allowed for gcDelay and gcInterval?</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configuring_s3_storage"><a class="anchor" href="#_configuring_s3_storage"></a><a class="link" href="#_configuring_s3_storage">Configuring S3 Storage</a></h4>
<div class="paragraph">
<p>Amazon Simple Storage Service (S3) for zot can be configured with the
<code>storageDriver</code> attribute in the configuration file, as shown in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"storageDriver": {
    "name": "s3",
    "region": "us-east-2",
    "bucket": "zot-storage",
    "secure": true,
    "skipverify": false,
    "accesskey": "&lt;YOUR_ACCESS_KEY_ID&gt;",
    "secretkey": "&lt;YOUR_SECRET_ACCESS_KEY&gt;"
}</pre>
</div>
</div>
<div class="paragraph">
<p>As in the case with local filesystem storage, you can use multiple storage
locations using the <code>subpath</code> attribute, as in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"subPaths": {
    "/a": {
        "rootDirectory": "/zot-a",
        "storageDriver": {
            "name": "s3",
            "region": "us-east-2",
            "bucket": "zot-storage",
            "secure": true,
            "skipverify": false
        }
    },
    "/b": {

[continue]</pre>
</div>
</div>
<div class="sect4">
<h5 id="_s3_credentials"><a class="anchor" href="#_s3_credentials"></a><a class="link" href="#_s3_credentials">S3 Credentials</a></h5>
<div class="paragraph">
<p>In the first configuration file example, the S3 credentials were configured with the
attributes <code>accesskey</code> and <code>secretkey.</code> As an alternative, you can omit these attributes
from the configuration file and you can configure them using environment variables or a
credential file.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Environment variables</p>
<div class="paragraph">
<p>Zot looks for credentials in the following environment variables:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>AWS_ACCESS_KEY_ID
AWS_SECRET_ACCESS_KEY
AWS_SESSION_TOKEN (optional)</pre>
</div>
</div>
</li>
<li>
<p>Credential file</p>
<div class="paragraph">
<p>A credential file is a plaintext file that contains your access keys, as shown in
the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[default]
aws_access_key_id = &lt;YOUR_DEFAULT_ACCESS_KEY_ID&gt;
aws_secret_access_key = &lt;YOUR_DEFAULT_SECRET_ACCESS_KEY&gt;

[test-account]
aws_access_key_id = &lt;YOUR_TEST_ACCESS_KEY_ID&gt;
aws_secret_access_key = &lt;YOUR_TEST_SECRET_ACCESS_KEY&gt;

[prod-account]
; work profile
aws_access_key_id = &lt;YOUR_PROD_ACCESS_KEY_ID&gt;
aws_secret_access_key = &lt;YOUR_PROD_SECRET_ACCESS_KEY&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>[default]</code> heading defines credentials for the default profile, which zot
will use unless you configure it to use another profile.  You can specify a profile using the
<code>AWS_PROFILE</code> environment variable as in this example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>AWS_PROFILE=test-account</pre>
</div>
</div>
<div class="paragraph">
<p>The credential file must be named <code>credentials.</code> It must be located in the
<code>.aws/</code> folder in the home directory of the same server that is running your zot
application.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more details about specifying S3 credentials, see the
<a href="https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html#specifying-credentials">AWS documentation</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">MIKE&#8217;S QUESTIONS</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Do I need to define the S3 config attributes?</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_authentication"><a class="anchor" href="#_authentication"></a><a class="link" href="#_authentication">Authentication</a></h3>
<div class="paragraph">
<p>Zot supports authentication by the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TLS mutual authentication</p>
</li>
<li>
<p>Local authentication using an htpasswd file</p>
</li>
<li>
<p>LDAP authentication</p>
</li>
<li>
<p>OAuth2 authentication using an HTTP Bearer token</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Zot also provides the ability to delay response to an authentication
failure in order to prevent automated attacks.</p>
</div>
<div class="sect3">
<h4 id="_tls_mutual_authentication"><a class="anchor" href="#_tls_mutual_authentication"></a><a class="link" href="#_tls_mutual_authentication">TLS Mutual Authentication</a></h4>
<div class="paragraph">
<p>Use the <code>tls</code> attribute under <code>http</code> in the configuration file to enable and
configure TLS mutual authentication, as shown in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"http": {
  "tls": {
    "cert":"test/data/server.cert",
    "key":"test/data/server.key",
    "cacert":"test/data/cacert.cert"
  }}</pre>
</div>
</div>
<div class="paragraph">
<p>The following table lists the configurable attributes.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cert</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path and filename of the server&#8217;s SSL/TLS certificate.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>key</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path and filename of the server&#8217;s registry key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cacert</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path and filename of the server&#8217;s <code>cacerts</code> file, which contains
trusted certificate authority (CA) certificates. Specifying the <code>cacert</code> field
enables TLS mutual authentication</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_local_authentication"><a class="anchor" href="#_local_authentication"></a><a class="link" href="#_local_authentication">Local Authentication</a></h4>
<div class="paragraph">
<p>Use the <code>auth</code> and <code>htpasswd</code> attributes under <code>http</code> in the configuration file
to enable and configure local authentication, as shown in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"http": {
  "auth": {
    "htpasswd": {
      "path": "test/data/htpasswd"
    }}}</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>path</code> attribute specifies the path and filename of the <code>.htpasswd</code> file, which
contains user names and hashed passwords.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When both htpasswd and LDAP configuration are specified, LDAP authentication
is given preference.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_ldap_authentication"><a class="anchor" href="#_ldap_authentication"></a><a class="link" href="#_ldap_authentication">LDAP Authentication</a></h4>
<div class="paragraph">
<p>Use the <code>auth</code> and <code>ldap</code> attributes under <code>http</code> in the configuration file
to enable and configure LDAP authentication, as shown in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"http": {
  "auth": {
    "ldap": {
      "address":"ldap.example.org",
      "port":389,
      "startTLS":false,
      "baseDN":"ou=Users,dc=example,dc=org",
      "userAttribute":"uid",
      "bindDN":"cn=ldap-searcher,ou=Users,dc=example,dc=org",
      "bindPassword":"ldap-searcher-password",
      "skipVerify":false,
      "subtreeSearch":true
    }}}</pre>
</div>
</div>
<div class="paragraph">
<p>The following table lists the configurable attributes.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>address</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The IP address or hostname of the LDAP server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The port number used by the LDAP service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>startTLS</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>baseDN</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>userAttribute</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bindDN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Base Distinguished Name for the LDAP search</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bindPassword</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>skipVerify</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>subtreeSearch</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When both htpasswd and LDAP configuration are specified, LDAP authentication
is given preference.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">MIKE&#8217;S QUESTIONS</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Need attribute definitions</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_oauth2_authentication"><a class="anchor" href="#_oauth2_authentication"></a><a class="link" href="#_oauth2_authentication">OAuth2 Authentication</a></h4>
<div class="paragraph">
<p>Zot supports OAuth2 by using a Bearer Token.  Use the <code>auth</code> and <code>bearer</code>
attributes under <code>http</code> in the configuration file to enable and configure OAuth2
authentication, as shown in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"http": {
  "auth": {
    "bearer": {
      "realm": "https://auth.myreg.io/auth/token",
      "service": "myauth",
      "cert": "/etc/zot/auth.crt"
    }}}</pre>
</div>
</div>
<div class="paragraph">
<p>The following table lists the configurable attributes.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>realm</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>service</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cert</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path and filename of the server&#8217;s SSL/TLS certificate.</p></td>
</tr>
</tbody>
</table>
<div class="sidebarblock">
<div class="content">
<div class="title">MIKE&#8217;S QUESTIONS</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Need attribute definitions</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_preventing_automated_attacks_with_failure_delay"><a class="anchor" href="#_preventing_automated_attacks_with_failure_delay"></a><a class="link" href="#_preventing_automated_attacks_with_failure_delay">Preventing Automated Attacks with Failure Delay</a></h4>
<div class="paragraph">
<p>Use the <code>auth</code> and <code>failDelay</code> attributes under <code>http</code> in the configuration file
to delay the response to an authentication failure. A delayed response helps to
prevent automated attacks. The configuration is shown in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"http": {
  "auth": {
    "failDelay": 5
  }}</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>failDelay</code> attribute specifies a waiting time, in seconds, before zot
sends a failure notification to an authenticating user who has been denied accress.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">MIKE&#8217;S QUESTIONS</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>What are the units, range, recommended value?</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_identity_based_authorization"><a class="anchor" href="#_identity_based_authorization"></a><a class="link" href="#_identity_based_authorization">Identity-Based Authorization</a></h3>
<div class="paragraph">
<p>User identity can be used as an authorization criterion for allowing actions on
one or more repository paths.  For specific users, you can choose to allow any
combination of read, create, update, or delete actions on specific paths.</p>
</div>
<div class="paragraph">
<p>For defining policies for specific repository paths, the paths can be specified
explicitly or by using <code>glob</code> patterns with simple or recursive wildcards.
When a repository path matches more than one path description, authorization
is granted based on the policy of the longest (most specific) path matched.  For
example, if policies are defined for path descriptions <strong>**</strong> and <code>repos2/repo,</code>
the <code>repos2/repo</code> path will match both <strong>**</strong> and <code>repos2/repo</code> descriptions.
In this case, the <code>repos2/repo</code> policy will be applied because it is longer.</p>
</div>
<div class="paragraph">
<p>Note that <strong>**</strong> effectively defines the default policy, as it matches any path
not matched by any other per-repository policy. To override all other policies,
you can specify a global admin policy.</p>
</div>
<div class="paragraph">
<p>Use the <code>accessControl</code> attribute in the configuration file to define a set of
identity-based authorization policies, as shown in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"accessControl": {
  "**": {
    "policies": [{
      "users": ["charlie"],
      "actions": ["read", "create", "update"]
    }],
    "defaultPolicy": ["read", "create"]
  },
  "tmp/**": {
    "defaultPolicy": ["read", "create", "update"]
  },
  "infra/*": {
    "policies": [{
        "users": ["alice", "bob"],
        "actions": ["create", "read", "update", "delete"]
      },
      {
        "users": ["mallory"],
        "actions": ["create", "read"]
      }
    ],
    "defaultPolicy": ["read"]
  },
  "repos2/repo": {
    "policies": [{
        "users": ["bob"],
        "actions": ["read", "create"]
      },
      {
        "users": ["mallory"],
        "actions": ["create", "read"]
      }
    ],
    "defaultPolicy": ["read"]
  },
  "adminPolicy": {
    "users": ["admin"],
    "actions": ["read", "create", "update", "delete"]
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, five policies are defined:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The default policy (<strong>**</strong>) gives all users the ability to
read or create content, while giving user "charlie" the additional ability to
update content.</p>
</li>
<li>
<p>The policy for <code>tmp/**</code> matches all repositories under <code>tmp</code> recursively
and allows all users to read, create, or update content in those repositories.</p>
</li>
<li>
<p>The policy for <code>infra/*</code> matches all repositories directly under <code>infra.</code>
Separate policies are defined for specific users, along with a default
read-only policy for all other users.</p>
</li>
<li>
<p>The policy for <code>repos2/repo</code> matches only that specific repository.</p>
</li>
<li>
<p>An admin policy (<code>adminPolicy</code>) gives the user "admin" global authorization to
read, create, update, or delete content in any repository, overriding all other
policies.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Always include the read action in any policy that you define.  The create,
update, and delete actions cannot be used without the read action.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">MIKE&#8217;S QUESTIONS</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Should <code>allowReadAccess</code> be documented here?</p>
</li>
<li>
<p>What&#8217;s the difference between <code>allowReadAccess</code> and <code>ReadOnly</code>?  Both appear in examples.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_metrics"><a class="anchor" href="#_metrics"></a><a class="link" href="#_metrics">Metrics</a></h3>
<div class="paragraph">
<p>The available methods for collecting metrics varies depending on whether your zot
installation is the minimal (dist-spec-only) build or the full build including extensions.</p>
</div>
<div class="sect3">
<h4 id="_collecting_metrics_using_a_node_exporter"><a class="anchor" href="#_collecting_metrics_using_a_node_exporter"></a><a class="link" href="#_collecting_metrics_using_a_node_exporter">Collecting Metrics Using a Node Exporter</a></h4>
<div class="paragraph">
<p>The minimal zot installation exposes internal metrics in a Prometheus format
through a node exporter. The configuration of the node exporter contains connection
details for the zot server from which it will scrape metrics. Metrics
are automatically enabled in the zot server upon first scrape from the
node exporter.  No extra configuration option is needed. Similarly, the metrics
are automatically disabled when the node exporter has not performed any scrapings
for some period.</p>
</div>
</div>
<div class="sect3">
<h4 id="_enabling_metrics_for_zot_with_extensions"><a class="anchor" href="#_enabling_metrics_for_zot_with_extensions"></a><a class="link" href="#_enabling_metrics_for_zot_with_extensions">Enabling Metrics for zot with Extensions</a></h4>
<div class="paragraph">
<p>Use the <code>metrics</code> attribute in the <code>extensions</code> section of the configuration file
to enable and configure metrics, as shown in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"extensions": {
  "metrics":{
    "enable":"true",
    "prometheus": {
      "path": "/metrics"
    }
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>The following table lists the configurable attributes.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>enable</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to <code>true</code> to enable metrics collection.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>prometheus</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The server path on which metrics will be exposed.</p></td>
</tr>
</tbody>
</table>
<div class="sidebarblock">
<div class="content">
<div class="title">MIKE&#8217;S QUESTIONS</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Are these the only attributes?</p>
</li>
<li>
<p>What additional info do we need about prometheus, etc?</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_synchronizing_registries"><a class="anchor" href="#_synchronizing_registries"></a><a class="link" href="#_synchronizing_registries">Synchronizing Registries</a></h3>
<div class="paragraph">
<p>Use the <code>sync</code> attribute in the configuration file to configure the periodic or
on-demand synchronization of your zot image registry with other image
registries, as shown in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"sync": {
    "credentialsFile": "./examples/sync-auth-filepath.json",
    "registries": [
    {
        "urls": ["https://registry1:5000"],
        "onDemand": false,
        "pollInterval": "6h",
        "tlsVerify": true,
        "certDir": "/home/user/certs",
        "maxRetries": 5,
        "retryDelay": "10m",
        "onlySigned": true,
        "content": [
        {
            "prefix": "/repo1/repo",
            "tags":
            {
                "regex": "4.*",
                "semver": true
            }
        },
        {
            "prefix": "/repo2/repo*"
        },
        {
            "prefix": "/repo3/**"
        },
        {
            "prefix": "/repo1/repo",
            "destination": "/localrepo",
            "stripPrefix": true
        },
        {
            "prefix": "/repo1/**",
            "destination": "/localrepo",
            "stripPrefix": true
        }]
    },
    {
        "urls": ["https://registry2:5000", "https://registry3:5000"],
        "pollInterval": "12h",
        "tlsVerify": false,
        "onDemand": false,
        "content": [
        {
            "prefix": "/repo2",
            "tags":
            {
                "semver": true
            }
        }]
    },
    {
        "urls": ["https://docker.io/library"],
        "onDemand": true,
        "tlsVerify": true,
        "maxRetries": 3,
        "retryDelay": "15m"
    }]
}</pre>
</div>
</div>
<div class="paragraph">
<p>The following table lists the configurable attributes.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">credentialsFile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The location of a local credentials file containing credentials for other registries.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">urls</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The URL of an upstream image registry.  You can specify a comma-separated list of
multiple URLs for the same registry in case one or more fails.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">onDemand</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>False: Pull all images not found in the local registry.</p>
</li>
<li>
<p>True: Pull any image not found in the local registry only when needed.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pollInterval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The period between polling of remote registries. If no value is
specified, no preiodic polling will occur.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tlsVerify</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>False: TLS will not be verified.</p>
</li>
<li>
<p>True: (Default) TLS will be verified.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">certDir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If a path is specified, use certificates at this path. If no path is
specified, use the default certificates directory.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxRetries</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of retries if an error occurs during either an
on-demand or periodic synchronization.
If no value is specified, no retries will occur.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">retryDelay</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The interval between retries. This attribute is mandatory when
maxRetries is configured.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">onlySigned</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>False: Synchronize signed or unsigned images.</p>
</li>
<li>
<p>True: Synchronize only signed images (either notary or cosigned).</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">content</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The included attributes in this section specify which content will be periodically
pulled.
If this section is not populated, periodically polling will not occur.
 The included attributes can also filter which on-demand images are pulled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">prefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">On the remote server, the path from which images will be pulled. This
path can be a string that exactly matches the remote path, or it can be a <code>glob</code> pattern.
For example, the path can include a wildcard (<strong>*</strong>) or a recursive wildcard (<strong>**</strong>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">destination</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the path under which pulled images are to be stored.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">stripPrefix</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies whether the prefix path from the source registry will be
retained or replaced when the image is stored in the [zotLowerName] registry.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>False: Retain the source prefix, append it to the destination path.</p>
</li>
<li>
<p>True: Remove the source prefix.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the source prefix was specified with
meta-characters (such as <strong>**</strong>), only the prefix segments that precede the
meta-characters are removed. Any remaining path segments are appended to the
destination path.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tags</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The included attributes in this optional section specify how remote
images will be selected for synchronization based on image tags.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">regex</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a regular expression for matching image tags. Images whose tags
do not match the expression are not pulled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">semver</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies whether image tags are to be filtered by semantic versioning (semver)
compliance.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>False: Do not filter by semantic versioning</p>
</li>
<li>
<p>True: Filter by semantic versioning</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
<div class="sidebarblock">
<div class="content">
<div class="title">MIKE&#8217;S QUESTIONS</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Is <code>sync</code> under <code>extensions</code>?</p>
</li>
<li>
<p>Are these the only attributes?</p>
</li>
<li>
<p>What are the defaults?</p>
</li>
<li>
<p>What are the units and ranges for intervals and retries?</p>
</li>
<li>
<p>Should we expand on semver compliance? Does it use the regex or are the separate?</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_clustering_zot"><a class="anchor" href="#_clustering_zot"></a><a class="link" href="#_clustering_zot">Clustering zot</a></h3>
<div class="paragraph">
<p>Zot supports a clustering scheme with stateless zot instances/replicas and a
shared remote storage to ensure high-availability of the zot registry.  With
this scheme, should a few replicas fail or become unavailable, the registry
service remains available. In addition, this scheme can increase
aggregate network throughput by load balancing across the many zot replicas.</p>
</div>
<div class="paragraph">
<p>Clustering is supported both in bare-metal and Kubernetes environments.</p>
</div>
<div class="sect3">
<h4 id="_bare_metal_deployment"><a class="anchor" href="#_bare_metal_deployment"></a><a class="link" href="#_bare_metal_deployment">Bare-metal Deployment</a></h4>
<div class="sect4">
<h5 id="_prerequisites_2"><a class="anchor" href="#_prerequisites_2"></a><a class="link" href="#_prerequisites_2">Prerequisites</a></h5>
<div class="ulist">
<ul>
<li>
<p>A highly-available loadbalancer such as HaProxy configured to point to backend
zot replicas</p>
</li>
<li>
<p>Remote storage (mounted locally or S3-compatible)</p>
</li>
<li>
<p>Zot configuration using above remote storage and with deduplication
and garbage-collection disabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_kubernetes_deployment"><a class="anchor" href="#_kubernetes_deployment"></a><a class="link" href="#_kubernetes_deployment">Kubernetes Deployment</a></h4>
<div class="sect4">
<h5 id="_prerequisites_3"><a class="anchor" href="#_prerequisites_3"></a><a class="link" href="#_prerequisites_3">Prerequisites</a></h5>
<div class="ulist">
<ul>
<li>
<p><code>helm</code> version X.Y.Z</p>
</li>
<li>
<p><code>Kubernetes</code> version A.B.C</p>
</li>
<li>
<p>Ingress controller</p>
</li>
<li>
<p>Remote storage (S3-compatible)</p>
</li>
<li>
<p>Zot configuration (as a ConfigMap) using above remote storage and
with deduplication and garbage-collection disabled</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If authentication is enabled on zot itself, that configuration
must also be identical across all replicas.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_solution_overview"><a class="anchor" href="#_solution_overview"></a><a class="link" href="#_solution_overview">Solution Overview</a></h4>
<div class="paragraph">
<p>clients &#8592;&#8594; loadbalancer &#8592;&#8594; [zot replicas] &#8592;&#8594; [[remote storage]]</p>
</div>
<div class="paragraph">
<p>All incoming requests from clients are first intercepted at the load balancer
and are then routed to one of the zot replicas, which then interfaces
with the remote storage.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_working_with_zli"><a class="anchor" href="#_working_with_zli"></a><a class="link" href="#_working_with_zli">Working with zli</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_what_is_zli"><a class="anchor" href="#_what_is_zli"></a><a class="link" href="#_what_is_zli">What is zli?</a></h3>
<div class="paragraph">
<p>zli is a binary that implements a set of command line commands for interacting
with the zot registry server.</p>
</div>
</div>
<div class="sect2">
<h3 id="_build_zli_from_source"><a class="anchor" href="#_build_zli_from_source"></a><a class="link" href="#_build_zli_from_source">Build zli from Source</a></h3>
<div class="paragraph">
<p>To build the zli binary, execute the <code>make cli</code> command in the zot directory.
Use the same command options that you used to build zot, as shown in this example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ make OS=darwin ARCH=amd64 cli</pre>
</div>
</div>
<div class="paragraph">
<p>The filename of the resulting executable file will reflect the build options.
For convenience, you can rename the executable to simply 'zli.'</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mv bin/zli-darwin-amd64 bin/zli</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_common_tasks_using_zli"><a class="anchor" href="#_common_tasks_using_zli"></a><a class="link" href="#_common_tasks_using_zli">Common Tasks Using zli</a></h3>
<div class="paragraph">
<p>This section includes a few examples of common zot server tasks using the <code>zli</code>
command line interface. To</p>
</div>
<div class="sect3">
<h4 id="_adding_a_zot_server_url"><a class="anchor" href="#_adding_a_zot_server_url"></a><a class="link" href="#_adding_a_zot_server_url">Adding a zot server URL</a></h4>
<div class="paragraph">
<p>You can modify the zot server configuration using the <a href="#_zli-config"><code>zli config add</code></a> command.
This example adds a zot server URL with an alias of "remote-zot":</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ bin/zli config add remote-zot https://server-example:8080</pre>
</div>
</div>
<div class="paragraph">
<p>Use the <a href="#_zli-config"><code>zli config</code></a> command to list all configured URLs with their aliases:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ bin/zli config -l
remote-zot   https://server-example:8080
local        http://localhost:8080</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_listing_images"><a class="anchor" href="#_listing_images"></a><a class="link" href="#_listing_images">Listing images</a></h4>
<div class="paragraph">
<p>You can list all images hosted on a zot server using the <a href="#_zli-images"><code>zli images</code></a> command with
the server&#8217;s alias:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ bin/zli images remote-zot

IMAGE NAME        TAG               DIGEST    SIZE
postgres          9.6.18-alpine     ef27f3e1  14.4MB
postgres          9.5-alpine        264450a7  14.4MB
busybox           latest            414aeb86  707.8KB</pre>
</div>
</div>
<div class="paragraph">
<p>You can also filter the image list to view a specific image by specifying the
image name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ bin/zli images remote-zot -n busybox

IMAGE NAME        TAG               DIGEST    SIZE
busybox           latest            414aeb86  707.8KB</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_scanning_images_for_known_vulnerabilities"><a class="anchor" href="#_scanning_images_for_known_vulnerabilities"></a><a class="link" href="#_scanning_images_for_known_vulnerabilities">Scanning images for known vulnerabilities</a></h4>
<div class="paragraph">
<p>Using the <a href="#_zli-cve"><code>zli cve</code></a> command, you can fetch the CVE (Common Vulnerabilities and
Exposures) information for images hosted on the zot server. This example shows
how to learn which images are affected by a specific CVE:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ bin/zli cve remote-zot -i CVE-2017-9935

IMAGE NAME        TAG               DIGEST    SIZE
c3/openjdk-dev    commit-5be4d92    ac3762e2  335MB</pre>
</div>
</div>
<div class="paragraph">
<p>This example displays a list all CVEs affecting a specific image:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ bin/zli cve remote-zot -I c3/openjdk-dev:0.3.19

ID                SEVERITY  TITLE
CVE-2015-8540     LOW       libpng: underflow read in png_check_keyword()
CVE-2017-16826    LOW       binutils: Invalid memory access in the coff_s...</pre>
</div>
</div>
<div class="paragraph">
<p>This example displays the detailed CVEs in JSON format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ bin/zli cve remote-zot -I c3/openjdk-dev:0.3.19 -o json
{
  "Tag": "0.3.19",
  "CVEList": [
    {
      "Id": "CVE-2019-17006",
      "Severity": "MEDIUM",
      "Title": "nss: Check length of inputs for cryptographic primitives",
      "Description": "A vulnerability was discovered in nss where input text length was not checked when using certain cryptographic primitives. This could lead to a heap-buffer overflow resulting in a crash and data leak. The highest threat is to confidentiality and integrity of data as well as system availability.",
      "PackageList": [
        {
          "Name": "nss",
          "InstalledVersion": "3.44.0-7.el7_7",
          "FixedVersion": "Not Specified"
        },
        {
          "Name": "nss-sysinit",
          "InstalledVersion": "3.44.0-7.el7_7",
          "FixedVersion": "Not Specified"
        },
        {
          "Name": "nss-tools",
          "InstalledVersion": "3.44.0-7.el7_7",
          "FixedVersion": "Not Specified"
        }
      ]
    }</pre>
</div>
</div>
<div class="paragraph">
<p>This example lists all images on a specific zot server that are affected by
a specific CVE:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ bin/zli cve remote-zot -I c3/openjdk-dev -i CVE-2017-9935

IMAGE NAME        TAG               DIGEST    SIZE
c3/openjdk-dev    commit-2674e8a    71046748  338MB
c3/openjdk-dev    commit-bd5cc94    0ab7fc76</pre>
</div>
</div>
<div class="paragraph">
<p>This example lists all images on a specific zot server where the CVE has been fixed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ bin/zli cve remote-zot -I c3/openjdk-dev -i CVE-2017-9935 --fixed

IMAGE NAME        TAG                       DIGEST    SIZE
c3/openjdk-dev    commit-2674e8a-squashfs   b545b8ba  321MB
c3/openjdk-dev    commit-d5024ec-squashfs   cd45f8cf  321MB</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_zli-command-reference"><a class="anchor" href="#_zli-command-reference"></a><a class="link" href="#_zli-command-reference">zli Command Reference</a></h3>
<div class="sect3">
<h4 id="_zli"><a class="anchor" href="#_zli"></a><a class="link" href="#_zli">zli</a></h4>
<div class="listingblock">
<div class="content">
<pre>$ bin/zli --help

Usage:
  zli [flags]
  zli [command]

Available Commands:
  completion  Generate the autocompletion script for the specified shell
  config      Configure zot registry parameters for CLI
  cve         Lookup CVEs in images hosted on the zot registry
  help        Help about any command
  images      List images hosted on the zot registry

Flags:
  -h, --help      help for zli
  -v, --version   show the version and exit

Use "zli [command] --help" for more information about a command.</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zli-completion"><a class="anchor" href="#_zli-completion"></a><a class="link" href="#_zli-completion">zli completion</a></h4>
<div class="paragraph">
<p>This command generates the autocompletion script for <code>zli</code> for the specified shell.
See each sub-command&#8217;s help for details on how to use the generated script.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ bin/zli completion --help

Usage:
  zli completion [command]

Available Commands:
  bash        Generate the autocompletion script for bash
  fish        Generate the autocompletion script for fish
  powershell  Generate the autocompletion script for powershell
  zsh         Generate the autocompletion script for zsh

Flags:
  -h, --help   help for completion

Use "zli completion [command] --help" for more information about a command.</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zli-config"><a class="anchor" href="#_zli-config"></a><a class="link" href="#_zli-config">zli config</a></h4>
<div class="paragraph">
<p>This command modifies and lists modified settings for a running zot registry.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ bin/zli config --help

Usage:
  zli config &lt;config-name&gt; [variable] [value] [flags]
  zli config [command]

Examples:
  zli config add main https://zot-foo.com:8080
  zli config main url
  zli config main --list
  zli config --list

Available Commands:
  add         Add configuration for a zot registry

Flags:
  -h, --help    help for config
  -l, --list    List configurations
      --reset   Reset a variable value

Use "zli config [command] --help" for more information about a command.

Useful variables:
  url		zot server URL
  showspinner	show spinner while loading data [true/false]
  verify-tls	enable TLS certificate verification of the server [default: true]</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zli-cve"><a class="anchor" href="#_zli-cve"></a><a class="link" href="#_zli-cve">zli cve</a></h4>
<div class="paragraph">
<p>This command lists CVEs (Common Vulnerabilities and Exposures) of images hosted
on the zot registry</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./zli cve --help

Usage:
  zli cve [config-name] [flags]

Flags:
  -i, --cve-id string   List images affected by a CVE
      --fixed           List tags which have fixed a CVE
  -h, --help            help for cve
  -I, --image string    List CVEs by IMAGENAME[:TAG]
  -o, --output string   Specify output format [text/json/yaml]. JSON and YAML format return all info for CVEs
      --url string      Specify zot server URL if config-name is not mentioned
  -u, --user string     User Credentials of zot server in USERNAME:PASSWORD format</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zli-images"><a class="anchor" href="#_zli-images"></a><a class="link" href="#_zli-images">zli images</a></h4>
<div class="paragraph">
<p>This command lists images hosted on the zot registry.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./zli images --help

Usage:
  zli images [config-name] [flags]

Flags:
  -d, --digest string   List images containing a specific manifest, config, or layer digest
  -h, --help            help for images
  -n, --name string     List image details by name
  -o, --output string   Specify output format [text/json/yaml]
      --url string      Specify zot server URL if config-name is not mentioned
  -u, --user string     User Credentials of zot server in "username:password" format
      --verbose         Show verbose output

Run 'zli config -h' for details on [config-name] argument</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_working_with_zb"><a class="anchor" href="#_working_with_zb"></a><a class="link" href="#_working_with_zb">Working with zb</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_what_is_zb"><a class="anchor" href="#_what_is_zb"></a><a class="link" href="#_what_is_zb">What is zb?</a></h3>
<div class="paragraph">
<p>You can benchmark a zot registry or any other dist-spec conformant registry with zb.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>What is zb?</p>
</li>
<li>
<p>Get zb</p>
<div class="ulist">
<ul>
<li>
<p>Downloading zb Binaries</p>
</li>
<li>
<p>Building zb From Source</p>
</li>
</ul>
</div>
</li>
<li>
<p>The zb Command Tree</p>
</li>
<li>
<p>Run Benchmarks with zb</p>
</li>
</ol>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">MIKE&#8217;S QUESTIONS</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>How to download binaries?</p>
</li>
<li>
<p>Where is the zb Command Tree?</p>
</li>
<li>
<p>How to run Benchmarks with zb?</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_advanced_topics_cookbook"><a class="anchor" href="#_advanced_topics_cookbook"></a><a class="link" href="#_advanced_topics_cookbook">Advanced Topics Cookbook</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_advanced_topics_cookbook_2"><a class="anchor" href="#_advanced_topics_cookbook_2"></a><a class="link" href="#_advanced_topics_cookbook_2">Advanced Topics Cookbook</a></h3>
<div class="paragraph">
<p><strong>This is a placeholder for the Advanced Topics Cookbook.</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a trusted image pipeline with zot, cosign, and Notation</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_notices"><a class="anchor" href="#_notices"></a><a class="link" href="#_notices">Notices</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_bias_free_language"><a class="anchor" href="#_bias_free_language"></a><a class="link" href="#_bias_free_language">Bias-Free language</a></h3>
<div class="paragraph">
<p>The documentation set for this project strives to use bias-free language. For the
purposes of this documentation set, bias-free is defined as language that does
not imply discrimination based on age, disability, gender, racial identity, ethnic
identity, sexual orientation, socioeconomic status, and intersectionality.
Exceptions may be present in the documentation due to language that is hardcoded
in the user interfaces of the project software, language used based on RFP
documentation, or language that is used by a referenced third-party product.</p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
